# 动态分析基础技术

## 沙箱：简便但粗糙的方法

沙箱是一种在安全环境里运行不信任程序的安全机制，不必担心伤害到真正的系统。沙箱包含一个虚拟环境，通过某种方式模拟网络服务，以确保被测试的软件或者恶意代码能正确执行。

### 使用恶意代码沙箱

很多分析恶意代码的沙箱 --- 都提供免费分析恶意代码的服务。 

Norman沙箱、GFI沙箱等 --- 都会提供一个分析报告 -- 执行的网络行为 / 文件操作 / 互斥量列表 / 对注册表的修改活动 / VirusTotal的扫描结果 等

### 沙箱的缺点

1.  沙箱只能简单运行可执行程序，不能带有命令行选项。如果恶意代码需要一些命令才能执行，在不提供选项的条件下，任何代码都不会执行。
2. 如果你分析的恶意代码样本是一个后门程序，需要等待一条控制指令才会启动特定行为，那么在沙箱中这个后门程序将无法被启动和分析。
3. 沙箱不能记录所有事件。例如，恶意代码设置为等待一天才会去执行它的恶意行为，那么就可能会错过这个事件。
4. 恶意代码经常检测它是否运行在一个虚拟机里，并且如果检测到了虚拟机，恶意代码将会停止运行or表现异常。不是所有沙箱都能完善考虑这个问题



## 运行恶意代码

## 进程监视器

### 进程监视器的显示

### 进程监视器中的过滤

## 使用进程浏览器来查看进程

### 进程浏览器的显示

### 使用验证选项

### 比较字符串

### 使用依赖遍历器

### 分析恶意文档

## 使用Regshot来比较注册表快照

## 模拟网络

## 使用Wireshark进行数据包监听

## 使用INetSim

## 基础动态分析工具实践

## 小结

## 实验

 
# Lab9-OllyDbg

## Lab9-1

用OllyDbg和IDAPro分析lab09-01.exe

1. 如何让这个恶意代码安装自身 
2. 这个恶意代码的命令行选项是什么？它要求的密码是什么？
3. 如何利用OllyDbg永久修补这个恶意代码，使其不需要指定的命令行代码
4. 这个恶意代码基于系统的特征是什么
5. 这个恶意代码通过网络命令执行了哪些不同的操作
6. 这个恶意代码是否有网络特征

## Lab9-2

分析Lab09-02.exe

1. 在二进制文件中，你看到的静态字符串是什么
2. 当你运行这个二进制文件时，会发生什么
3. 如何让恶意代码的payload获得运行
4. 地址0x00401133处发生了什么
5. 传递给子例程0x00401089的参数是什么
6. 恶意代码使用的域名是什么
7. 恶意代码使用的什么编码函数来混淆域名
8. 恶意代码在 0x0040106E 调用CreateProcessA函数的意义是什么

## lab9-3

分析Lab09-03.exe。这个恶意代码加载 DLL1.dll / DLL2.dll / DLL3.dll，它们在编译时请求相同的内存加载位置。因此，在OllyDbg中对照IDA Pro可以发现，相同代码可能会出现在不同的内存位置。--- 只用OllyDng可以轻松的在IDA Pro中找到对应位置

1. Lab09-03.exe导入了哪些dll
2. DLL1.dll / DLL2.dll / DLL3.dll 要求的基地址是多少
3. 使用OllyDbg调试Lab09-03.exe时，为DLL1.dll / DLL2.dll / DLL3.dll分配的基地址是什么
4. 当Lab09-03.exe 调用DLL1.dll中的一个导入函数时，这个导入函数都做了什么
5. 当Lab09-03.exe 调用 WriteFile 函数是，它写入的文件名是什么
6. 当Lab09-03.exe 调用 NetScheduleJobAdd创建一个job时，从那里获取第二个参数的数据？
7. 在运行或调试 Lab09-03.exe时，你会看到Lab09-03.exe打印出三块神秘数据，DLL1的神秘数据 / DLL2的神秘数据 / DLL3的神秘数据分别是什么？
8. 如何将DLL2.dll加载到IDA Pro中，使得它与OllyDbg使用的加载地址匹配？

---

题目如上，加油呀 (ง •_•)ง

---

## Lab9-1


## Lab9-2

分析Lab09-02.exe

1. 在二进制文件中，你看到的静态字符串是什么

    用 `Strings`查看字符串，结果如下 -- 很多导入函数和字符串`cmd`
    ```s
    ...
    GetLastActivePopup
    GetActiveWindow
    MessageBoxA
    user32.dll
    Y6@
    ]6@
    WaitForSingleObject
    CreateProcessA
    Sleep
    GetModuleFileNameA
    KERNEL32.dll
    WSASocketA
    WS2_32.dll
    GetCommandLineA
    GetVersion
    ExitProcess
    TerminateProcess
    GetCurrentProcess
    UnhandledExceptionFilter
    FreeEnvironmentStringsA
    FreeEnvironmentStringsW
    WideCharToMultiByte
    GetEnvironmentStrings
    GetEnvironmentStringsW
    SetHandleCount
    GetStdHandle
    GetFileType
    GetStartupInfoA
    HeapDestroy
    HeapCreate
    VirtualFree
    HeapFree
    RtlUnwind
    WriteFile
    HeapAlloc
    GetCPInfo
    GetACP
    GetOEMCP
    VirtualAlloc
    HeapReAlloc
    GetProcAddress
    LoadLibraryA
    MultiByteToWideChar
    LCMapStringA
    LCMapStringW
    GetStringTypeA
    GetStringTypeW
    cmd
    ...
    ```

2. 当你运行这个二进制文件时，会发生什么

    用 `Process Explorer`监控，运行 `exe`并不能看到什么有用的信息--- 推测这个恶意程序并没有做什么就结束了

3. 如何让恶意代码的payload获得运行


4. 地址0x00401133处发生了什么
    
5. 传递给子例程0x00401089的参数是什么
6. 恶意代码使用的域名是什么
7. 恶意代码使用的什么编码函数来混淆域名
8. 恶意代码在 0x0040106E 调用CreateProcessA函数的意义是什么